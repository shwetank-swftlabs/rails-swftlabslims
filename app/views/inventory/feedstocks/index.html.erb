<% content_for :page_title, render("shared/page_title",
  subtitle: "Manage feedstocks and their data.",
  actions: render("shared/add_button", label: "Add New Feedstock", path: new_inventory_feedstock_path)
) %>

<!-- UNIFIED FILTER BAR -->
<%= render "shared/tables/default_filter_bar",
      url: inventory_feedstocks_path,
      search_placeholder: "Search by nameâ€¦",
      filter_fields: ->(f) do %>

  <!-- Type Filter -->
  <div class="col-md-3">
    <%= f.select :feedstock_type_id,
        Admin::FeedstockType.all.map { |ft| [ft.name.humanize, ft.id] },
        {
          include_blank: "Filter by Type",
          selected: params[:feedstock_type_id]
        },
        class: "form-select",
        onchange: "this.form.submit();" %>
  </div>

  <!-- Active Status Filter -->
  <div class="col-md-3">
    <%= f.select :is_active,
        [["Active", "true"], ["Inactive", "false"]],
        {
          include_blank: "Filter by Status",
          selected: params[:is_active]
        },
        class: "form-select",
        onchange: "this.form.submit();" %>
  </div>

<% end %>

<!-- FEEDSTOCK TABLE -->
<%= render "shared/tables/default_table",
      collection: @feedstocks,
      pagy: @pagy,
      headers: ->(_) do %>
        <th>Name</th>
        <th>Type</th>
        <th>Amount Remaining</th>
        <th>Location</th>
        <th>Supplier</th>
        <th>Status</th>
        <th>Print QR</th>
      <% end,
      row: ->(feedstock) do %>
        <td><%= link_to feedstock.name, inventory_feedstock_path(feedstock), class: "text-decoration-underline fw-semibold" %></td>
        <td><%= feedstock.feedstock_type.name.humanize %></td>
        <td><%= "#{feedstock.remaining_amount} #{feedstock.unit.humanize}" %></td>
        <td><%= feedstock.location.present? ? feedstock.location : "N/A" %></td>
        <td><%= feedstock.supplier.present? ? feedstock.supplier : "N/A" %></td>
        <td>
          <% if feedstock.is_active? %>
            <span class="badge bg-success">
              <i class="bi bi-check-circle me-1"></i>Active
            </span>
          <% else %>
            <span class="badge bg-danger">
              <i class="bi bi-x-circle me-1"></i>Inactive
            </span>
          <% end %>
        </td>
        <td><%= render "shared/print_qr_button", 
                        qr_code_path: qr_code_inventory_feedstock_path(feedstock),
                        label: "Print QR" %>
        </td>
      <% end %>

