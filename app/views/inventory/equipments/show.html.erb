<% content_for :page_title,
   render("shared/page_title",
     subtitle: "View and manage equipment information.",
     actions: render("shared/print_qr_button", qr_code_path: qr_code_inventory_equipment_path(@equipment))
   )
%>

<%= render "shared/sidebar_layout/layout",
    tabs: ["details", "maintenance_schedules", "operation_manual", "images", "comments"],
    tab_path: :inventory_equipment_path,
    path_args: [@equipment],
    bottom_action: render("shared/edit_button", label: "Edit Equipment", path: edit_inventory_equipment_path(@equipment)) do %>

  <% 
    tab_name = params[:tab] || "details"
    # Map maintenance_schedules tab to maintenance_records partial
    # Use full path to ensure it works when rendered from different controller
    if tab_name == "maintenance_schedules"
      tab_name = "inventory/equipments/maintenance_records"
    end
    
    # Pass maintenance_schedule if it exists (from failed create)
    render_options = { equipment: @equipment }
    render_options[:maintenance_schedule] = @maintenance_schedule if defined?(@maintenance_schedule) && @maintenance_schedule.present?
  %>
  <%= render tab_name, render_options %>

<% end %>
