<% content_for :page_title, render("shared/page_title",
  subtitle: "Manage cakes and their data.",
  actions: render("shared/add_button", label: "Add New Cake", path: new_products_cake_path)
) %>

<!-- UNIFIED FILTER BAR -->
<%= render "shared/tables/default_filter_bar",
      url: products_cakes_path,
      search_placeholder: "Search by name…",
      filter_fields: ->(f) do %>

  <!-- Batch Number Search -->
  <div class="col-md-4">
    <div class="input-group">
      <%= f.text_field :batch_number,
            value: params[:batch_number],
            placeholder: "Search by batch number…",
            class: "form-control" %>
      <%= f.submit "Search", class: "btn btn-secondary" %>
    </div>
  </div>

<% end %>

<!-- CAKE TABLE -->
<%= render "shared/tables/default_table",
      collection: @cakes,
      pagy: @pagy,
      headers: ->(_) do %>
        <th>Name</th>
        <th>Batch Number</th>
        <th>Quantity</th>
        <th>Created By</th>
        <th>Created At</th>
        <th>Print QR</th>
      <% end,
      row: ->(cake) do %>
        <td><%= link_to cake.name, products_cake_path(cake), class: "text-decoration-underline fw-semibold" %></td>
        <td><%= cake.batch_number.present? ? cake.batch_number : "N/A" %></td>
        <td><%= "#{cake.quantity} #{cake.unit.upcase}" %></td>
        <td><%= cake.created_by %></td>
        <td><%= format_date(cake.created_at) %></td>
        <td><%= render "shared/print_qr_button", 
                        qr_code_path: qr_code_products_cake_path(cake),
                        label: "Print QR" %>
        </td>
      <% end %>

