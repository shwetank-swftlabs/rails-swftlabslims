<% qnc_checks = local_assigns[:qnc_checks] || @qnc_checks || [] %>

<div class="table-responsive">
  <table class="table table-striped table-hover align-middle table-compact">
    <thead class="table-light border-bottom">
      <tr>
        <th>Name</th>
        <th>Resource</th>
        <th>Location</th>
        <th>Assigned To</th>
        <th>Expected Completion</th>
        <th>Requested By</th>
        <th>Status</th>
        <th>Created At</th>
        <th>Print QR</th>
      </tr>
    </thead>

    <tbody>
      <% if qnc_checks.any? %>
        <% qnc_checks.each do |qnc_check| %>
          <!-- QNC Check Row -->
          <tr>
            <td>
              <%= link_to qnc_check.name.presence || "Unnamed",
                          experiments_qnc_check_path(qnc_check),
                          class: "text-decoration-underline fw-semibold" %>
            </td>
            <td>
              <% parent = qnc_check.qnc_checkable %>
              <% if parent.present? && parent.respond_to?(:name) && parent.name.present? %>
                <%= link_to parent.name, polymorphic_path(parent), class: "text-decoration-underline" %>
              <% else %>
                —
              <% end %>
            </td>
            <td><%= qnc_check.location.presence || "—" %></td>
            <td><%= qnc_check.requested_from.present? ? email_to_name(qnc_check.requested_from) : "—" %></td>
            <td><%= qnc_check.expected_completion_date.present? ? format_date(qnc_check.expected_completion_date) : "—" %></td>
            <td><%= qnc_check.requested_by.present? ? email_to_name(qnc_check.requested_by) : "—" %></td>
            <td>
              <% if qnc_check.is_active? %>
                <span class="badge bg-warning text-dark">
                  <i class="bi bi-clock me-1"></i>Pending
                </span>
              <% else %>
                <span class="badge bg-success">
                  <i class="bi bi-check-circle me-1"></i>Completed
                </span>
              <% end %>
            </td>
            <td><%= format_date(qnc_check.created_at) %></td>
            <td>
              <%= render "shared/print_qr_button", 
                          qr_code_path: qr_code_experiments_qnc_check_path(qnc_check),
                          label: "Print QR" %>
            </td>
          </tr>
        <% end %>
      <% else %>
        <tr>
          <td colspan="9" class="text-muted text-center py-3">No QNC checks found.</td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<% if defined?(@pagy) && @pagy.present? %>
  <div class="mt-3">
    <%== @pagy.series_nav(:bootstrap) %>
  </div>
<% end %>



